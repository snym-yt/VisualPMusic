<!DOCTYPE html>
<html lang="ja">

  <head>
    <title>PMusic</title>
    <script src="https://cdn.jsdelivr.net/npm/blockly@1.0.0/blockly_compressed.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/blockly@1.0.0/blocks_compressed.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/blockly@1.0.0/msg/js/en.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/blockly@1.0.0/javascript_compressed.min.js"></script>
    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <!-- <meta http-equiv="Cache-Control" content="no-store"> -->
  </head>

  <body>

  <!-- 言語選択ポップアップ -->
  <div class="bg_onetime_popup" id="languagePopup">
    <div class="onetime_popup">
      <div class="onetime_popup_title">
        <span class="onetime_popup_title_close" id="popupCloseButton"></span>
        <span>言語選択 (Choose Language)</span>
      </div>
      <div class="onetime_popup_content">
        <button class="languageButton" onclick="setLanguage('ja'); closePopup();">日本語</button>
        <button class="languageButton" onclick="setLanguage('en'); closePopup();">English</button>
      </div>
    </div>
  </div>

  <script>
    window.addEventListener('load', function () {
      const body = document.querySelector('body');
      const languagePopup = document.getElementById('languagePopup');
      body.classList.add('open_popup');
      // ポップアップ内のクリックイベント伝播を防ぐ
      languagePopup.querySelector('.onetime_popup').addEventListener('click', function (e) {
        e.stopPropagation();
        console.log('Popup clicked');
      });
    }, false);
  </script>
  
  

  <div id="content" style="display:flex;">
    <div>
      <!-- コード反映欄 -->
      <div id="code" style="width: 750px; padding: 5px; border: 2px solid black;"><pre/></div>
      <button onclick="runCode();">Run</button> <button onclick="copyCode();">Copy</button>
    </div>
    <!-- ブロック配置欄 -->
    <div id="blocklyDiv" style="height: 650px; width: 1150px; padding: 5px"></div>
  </div>

  <!-- 説明欄 -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <script src="https://cdn.jsdelivr.net/npm/marked@3.0.7/marked.min.js"></script> -->
  <script src="./marked-3.0.7/marked.min.js"></script>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <!-- MIDIノートナンバーの画像 -->
  <div class="flex-container">
    <img src="Instruction/figures/NOTE_number.jpeg" alt="MIDI ノートナンバー">
    <div class="scroll-container" id="markdown_preview"> <!-- ここに出力される --> </div>
  </div>
  <script src="Instruction/inst_markdown.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/markdown-it/13.0.2/markdown-it.min.js" integrity="sha512-ohlWmsCxOu0bph1om5eDL0jm/83eH09fvqLDhiEdiqfDeJbEvz4FSbeY0gLJSVJwQAp0laRhTXbUQG+ZUuifUQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<!-- ------------------------------------------------------------------------------------------------------------------------------ -->

  <xml id="toolbox" style="display: none">
    <category name="General">
      <block type="controls_if"></block>
      <!-- <block type="controls_repeat_ext"></block> -->
      <block type="logic_compare"></block>
      <block type="math_number"></block>
      <block type="math_arithmetic"></block>
      <!-- <block type="text"></block>
      <block type="text_print"></block> -->
    </category>

    <category name="Music" colour="0">
      <block type="play1"></block>
      <block type="play"></block>
      <!-- <block type="random"></block> -->
      <block type="gauss1"></block>
      <block type="gauss"></block>
      <block type="weibul1"></block>
      <block type="weibul"></block>
      <block type="randwalk"></block>
    </category>

    <category name="Loops" colour="120">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
      <!-- <block type="loop"></block> -->
    </category>


    <category name="Variables" colour="330" custom="VARIABLE"></category>

    <category name="Lists" colour="260">
      <block type="lists_create_with">
        <mutation items="0"></mutation>
      </block>
      <block type="lists_create_with"></block>
      <block type="lists_length"></block>
    </category>
  </xml>

  <xml id="startBlocks" style="display: none">
    <block type="controls_repeat_ext" x="20" y="20"></block>
  </xml>


<!-- ------------------------------------------------------------------------------------------------------------------------------ -->

    <script src="script.js"></script>


  </body>

</html>

